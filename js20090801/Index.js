$(function() { var m = '<div class="caozuo"><a href="http://passport.panli.com/Register/" class="zhuce">立即免费注册</a><a target="_blank" href="/shopping_demo/" class="yanshi">代购演示</a></div>'; var l = $("#banner"); var h = 0; var d = h; var g = false; var f = -1; var c; var a = []; a[0] = $("#bannerbtn0"); a[1] = $("#bannerbtn1"); a[2] = $("#bannerbtn2"); $("#bannerUp").click(function() { if (d == h) { clearTimeout(c); d = h > 0 ? h - 1 : 2; j(); } }); $("#bannerDown").click(function() { if (d == h) { clearTimeout(c); j(); } }); $.each(a, function(b, n) { n.hover(function() { g = true; f = b; if (d == h) { clearTimeout(c); if (d == b) { return; } d = b; j(); } }, function() { g = false; f = -1; if (d == h) { clearTimeout(c); c = setTimeout(j, 10000); } }); }); function i() { a[0].attr("class", "cutover_1"); a[1].attr("class", "cutover_2"); a[2].attr("class", "cutover_3"); } var k = []; k[0] = $("li", l); k[2] = $('<li class="banner_3"><p>想团什么你来说，全球华人等你来号召，就等你了！<br />你的团购你做主，你来砍价谁敢拦？开团越多，省越多！</p>' + m + '<dl class="chakan"><dd><a href="/GroupPurchasing/">大家在团什么？</a></dd><dt><a href="/Help/Search.aspx?sc=21" target="_blank">查看团购规则</a></dt></dl></li>'); k[1] = $('<li class="banner_2"><p>拼单买国货，国内免运费...<br />无需为淘那件心爱的连衣裙而花费太多时间，别人帮你找好，就等你来拼单了。</p>' + m + '<dl class="chakan"><dd><a href="/Piece/">看看大家拼些什么？</a></dd><dt><a href="/Help/Search.aspx?sc=22" target="_blank">查看拼单购规则</a></dt></dl></li>'); $.each(k, function(b, n) { n.mousemove(function() { clearTimeout(c); c = setTimeout(j, 10000); }); }); var j = function() { d = h != d ? d : (h > 1 ? 0 : h + 1); i(); a[d].attr("class", "cutover_" + (d + 1) + "_"); l.append(k[d]); k[d].css("margin-top", "-248px").hide().fadeIn(1000); k[h].css("z-index", 10).fadeOut(1000, function() { $(this).css("z-index", 1).remove(); k[d].css("margin-top", "0"); h = d; if (!g) { clearTimeout(c); c = setTimeout(j, 10000); } else { if (f >= 0 && f != h) { d = f; j(); } } }); }; c = setTimeout(j, 10000); var e = function(n, b) { if (n.length > b) { return n.substring(0, b - 2) + "..."; } return n; }; $.getJSON("/App_Scripts/JSData/MaqueeProductInfo.ashx?r=" + Math.random(), function(n) { var b = $("<ul></ul>"); $("#Slider").empty().append(b); $.each(n, function(o, p) { b.append('<li><div class="detailed"><div class="pic"><a href="/See/?type=' + p.c + "#" + p.id + '"><img alt="' + p.n + '" src="' + p.p + '" /></a></div><div class="info"><h2><a href="/See/?type=' + p.c + "#" + p.id + '">' + e(p.n, 40) + "</a></h2><dl><dd><b>￥" + p.m.toFixed(2) + "</b><span>" + p.d + '</span></dd><dd class="i_bj">代购信息：<i>' + p.un + "</i>购买于" + p.s + '</dd></dl></div></div><div class="concise"><p><a href="/See/?type=' + p.c + "#" + p.id + '">' + e(p.n, 25) + "</a></p><span>" + p.d + "</span></div></li>"); }); (function(v, x) { var w = true; var u = b; var o = 0; var p; var t = 1; var y = u.find(".concise:eq(0)").outerHeight(); u.scrollTop(0); u.children().each(function() { o += $(this).outerHeight(); }); u.append(u.html()); var q = u.find("li:eq(1)"); $(q).find(".detailed").show(); $(q).find(".concise").hide(); var z = function() { var s = u.scrollTop(); if (s >= o) { q = u.find("li:eq(0)"); u.find(".detailed").hide(); $(q).find(".detailed").show(); $(q).find(".concise").hide(); } u.scrollTop((s >= o ? 0 : s) + t); if (u.scrollTop() % y == 0) { r(); } }; function r() { t = 0; if (w) { setTimeout(function() { $(q).find(".concise").show(); q = $(q).next("li:first"); if (!q) { q = u.find("li:first"); } u.find(".detailed").hide(); $(q).find(".detailed").show(); $(q).find(".concise").hide(); w = true; t = 1; }, x); } w = false; } u.find("li").mouseover(function() { u.find(".detailed").hide(); $(this).find(".detailed").show(); $(this).find(".concise").hide(); clearInterval(p); }); u.find("li").mouseout(function() { u.find(".detailed").hide(); $(this).find(".concise").show(); $(q).find(".detailed").show(); $(q).find(".concise").hide(); p = setInterval(z, v); }); p = setInterval(z, v); })(30, 3000); }); (function() { var n = $("#GroupLimit").val(); var b = function() { var r = n--; if (r <= 0) { $("#GTime").html("已截团"); return; } var p = parseInt(r / 86400); r %= 86400; var o = parseInt(r / 3600); r %= 3600; var t = parseInt(r / 60); r %= 60; var q = r; $("#Day").text(p); $("#Hour").text(o); $("#Minute").text(t); $("#Second").text(n); $("#GTime").html("剩余<i>" + p + "</i>天<i>" + o + "</i>小时<i>" + t + "</i>分<i>" + q + "</i>秒"); }; setInterval(b, 1000); })(); $.getJSON("/App_Scripts/JSData/Index_PanliRecommend.ashx?r=" + Math.random(), function(b) { var o = $('<div class="g_left"><a href="javascript:;" title="向左"></a></div>').click(function() { clearTimeout(s); if (v != w) { return; } p(v - 1); }); var x = $('<div class="g_right"><a href="javascript:;" title="向右"></a></div>').click(function() { clearTimeout(s); if (v != w) { return; } p(); }); var t = $('<div class="g_box"></div>'); var n = $('<div class="g_center"></div>').append(t).hover(function() { clearTimeout(s); u = true; }, function() { clearTimeout(s); u = false; s = setTimeout(function() { p(); }, 3000); }); $.each(b, function(y, z) { var r = $("<ul></ul>"); $.each(z, function(B, A) { r.append('<li><div class="g_pic"><a href="/PanliRecommend/Product.aspx?pid=' + A.id + '" target="_blank"><img src="' + A.p + '" alt="' + A.n + '" /></a><p>已购买' + A.s + '件</p></div><h2><a href="/PanliRecommend/Product.aspx?pid=' + A.id + '" target="_blank">' + A.n + "</a></h2><span>￥" + A.m + "</span></li>"); }); t.append(r); }); t.append(t.children().clone()).width(660 * b.length * 2); $("#Recommend").empty().append(o).append(n).append(x); var s = setTimeout(function() { p(); }, 5000); var v = 0; var w = v; var u = false; var q = t.find("ul").length; var p = function(r) { w = (r || r == 0) ? r : v + 1; if (w >= q) { w = b.length; t.css("margin-left", 0 - 660 * (w - 1)); } if (w < 0) { w = b.length - 1; t.css("margin-left", 0 - 660 * (w + 1)); } t.fadeTo("fast", 0.5).animate({ marginLeft: (0 - 660 * w) + "px" }, 800, function() { $(this).fadeTo("fast", 1); v = w; clearTimeout(s); if (!u) { s = setTimeout(function() { p(); }, 5000); } }); }; }); $("#navi ul li:first-child").addClass("qh"); $("#navi ul li:last-child").addClass("wu"); $(".desc").hide(); $("#desc1").show(); $("#navi ul li ").mouseover(function() { $("#navi ul li").removeClass(); $(this).addClass("qh"); if ($(this).next("li").length == 0) { $(this).prev("li").addClass("wu"); } else { $(this).next("li").addClass("wu"); } $(".desc").hide(); $(".desc:eq(" + $("#navi ul li").index(this) + ")").show(); }); });